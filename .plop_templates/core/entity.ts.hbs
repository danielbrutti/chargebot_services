import { Insertable, Selectable, Updateable } from 'kysely'
import { AuditedEntity } from "./audited_entity";

{{#each attributes}}
{{#when type 'eq' 'enum'}}
export enum {{pascalCase enum_name}} {
  {{#each enum_values}}
  {{constantCase this}} = "{{constantCase this}}"
  {{/each}}
}
{{/when}}
{{/each}}

export interface {{pascalCase name}}Table extends AuditedEntity {
  {{#each attributes}}
  {{#if unique}}
  {{snakeCase attribute}}: {{#when type 'neq' 'enum'}}{{tsType}}{{/when}}{{#when type 'eq' 'enum'}}{{pascalCase enum_name}}{{/when}};
  {{else if not_null}}
  {{snakeCase attribute}}: {{#when type 'neq' 'enum'}}{{tsType}}{{/when}}{{#when type 'eq' 'enum'}}{{pascalCase enum_name}}{{/when}};
  {{else}}
  {{snakeCase attribute}}?: {{#when type 'neq' 'enum'}}{{tsType}}{{/when}}{{#when type 'eq' 'enum'}}{{pascalCase enum_name}}{{/when}};
  {{/if}}
  {{/each}}
  {{#each relationships}}
  {{#if not_null}}
  {{snakeCase entity}}_id: number;
  {{else}}
  {{snakeCase entity}}_id?: number;
  {{/if}}
  {{/each}}
}

// You should not use the table schema interfaces directly. Instead, you should
// use the `Selectable`, `Insertable` and `Updateable` wrappers. These wrappers
// make sure that the correct types are used in each operation.
export type {{pascalCase name}} = Selectable<{{pascalCase name}}Table>
export type New{{pascalCase name}} = Insertable<{{pascalCase name}}Table>
export type {{pascalCase name}}Update = Updateable<{{pascalCase name}}Table>
